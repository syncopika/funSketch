<!doctype html>

<html>

<head>
	<title> funSketch! </title>
	<link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script type="text/javascript" src="scripts/SuperCanvas.js"></script>
	<script type="text/javascript" src="scripts/Brush.js"></script>
	<script type="text/javascript" src="scripts/Toolbar.js"></script>
	<script type="text/javascript" src="scripts/Filters.js"></script>
	<!-- web worker file needs to be in same directory as html file it's working on!
		 https://stackoverflow.com/questions/30336685/404-error-when-trying-to-register-serviceworker
	-->
	<script type="text/javascript" src="gif.worker.js"></script>
	<script type="text/javascript" src="scripts/gif.js"></script>
	
</head>

<style>
	html{
		display: none;
	}
	body, button{
		font-family: 'Merriweather', serif;
	}
	#buttons{
		text-align: center;
		border: 1px solid #000;
	}
	button{
		margin: 3px;
	}
	#toolbarArea{
		width: 400px;
		text-align: center;
		margin-left: 50px;
	}
	#canvasArea{
		margin: 20px auto;
		width: 40%;
		padding-left: 180px;
		height: auto;
	}
	#pageCount{
		text-align: center;
	}
	#pageCount h3{
		display: inline-block;
	}
	#count{
		padding-left: 50px;
		padding-right: 50px;
	}
	#footer{
		clear: both;
		margin-top: 100px;
		width: 20%;
		float: left;
	}
	#filters, #brushes{
		width: 150px;
		text-align: center;
		border: 1px solid #000;
		display: inline-block;
	}
	#colorPicker{
		margin-top: 10%;
		margin-bottom: 15%;
	}
	li{
		list-style-type: none;
	}
	ul:not(#timeOptions){
		display: none;
		padding: 0;
	}
	a{
		text-decoration: none;
	}
	#filterChoices li:hover{
		color: #99b5d1;
	}
	#timeOptions{
		padding: 0;
	}
	#timeOptions li{
		display: inline-block;
	}
	#animationControl{
		text-align: center;
	}
</style>

<body>

<div id='canvasArea'>
	<div id='pageCount'>
			<h3> << </h3>
			<h3 id='count'> 1 </h3>
			<h3> >> </h3>
	</div>
</div>

<div id='toolbarArea'>

	<h3 id='title'> funSketch: draw, edit, and animate! </h3>

	<p> tip! use the spacebar to create a new frame. use the left and right arrow keys to move to the previous or next frame! </p>

	<div id='buttons'>
		<button id='addCanvas' onclick='newCanvas.setupNewCanvas()'>add a new canvas</button>
		<button id='copyCanvas' onclick='newCanvas.copyCanvas()'>copy current canvas</button>
		<button id='clearCanvas'>clear the current canvas</button>
		<button id='importImage'> import image </button>
		<button id='rotateCanvasImage'>rotate image</button>
		<button id='download'> download current frame </button>
		<button id='undo'> undo </button>
	</div>
	
	<br>
	
	<div id='filters'>
		<p id='filterSelect'> filters &#9660; </p>
		<ul id='filterChoices'>
			<li onclick='newFilters.filterCanvas(newFilters.grayscale)'> grayscale </li>
			<li onclick='newFilters.filterCanvas(newFilters.saturate)'> saturate </li>
			<li onclick='newFilters.filterCanvas(newFilters.swap)'> colorswap </li>
			<li onclick='newFilters.filterCanvas(newFilters.scary)'> scary </li>
			<li onclick='newFilters.filterCanvas(newFilters.heatwave)'> heatwave </li>
			<li onclick='newFilters.filterCanvas(newFilters.randomize)'> noise </li>
			<li onclick='newFilters.filterCanvas(newFilters.invert)'> invert </li>
			<li onclick='newFilters.filterCanvas(newFilters.blurry)'> blur </li>
			<li onclick='newFilters.outline()'> outline </li>
			<li onclick='newFilters.defaultFisheye()'> fisheye </li>
			<li onclick='newFilters.filterCanvas(newFilters.areaColor)'> painted </li>
			<li style="color: #ff3232" onclick='newToolbar.resetImage()'> reset </li>
		</ul>
	</div>

	<div id='brushes'>
		<p id='brushSelect'> brushes &#9660; </p>
		<ul>
			<li><button onclick='newBrush.defaultBrush()'> default brush </button></li>
			<li><button onclick='newBrush.radialGradBrush()'> radial gradient brush </button></li>
		</ul>
	</div>

	
	<br>
	
	<div id='adjustBrushSize'>
		<p class="text-info">change brush size</p>
		<input id='brushSize' type='range' min='1' max='15' step='.5' value='2' oninput='newBrush.changeBrushSize(this.value); showSize()'>
		<span id='brushSizeValue'> 2 </span>
	</div>
	
	<br>
	
	<div id='colorPicker'>
	</div>
	
	<div id='animationControl'>
		<h3> animation control </h3>
		<ul id='timeOptions'>
			<li onclick='newToolbar.playBackward()'> &larr; </li>
			<li onclick='newToolbar.stop()'> stop! </li>
			<li onclick='newToolbar.playForward()'> &rarr; </li>
		</ul>
		<label>time per frame:</label>
		<select id='timePerFrame' onchange='newToolbar.timePerFrame = parseInt(value)'>
			<option value='1000'>1000</option>
			<option value='500'>500</option>
		</select>
		<button onclick='newToolbar.getGif()'> generate gif! </button>
	</div>
	
</div>


<div id='footer'>
	<hr>
	<p> n.c.h works 2017 | <a href='https://github.com/syncopika/funSketch'>source </a></p>
</div>
	
</body>


<script>

// set up initial canvas
var newCanvas = new SuperCanvas('canvasArea');
newCanvas.setupNewCanvas();

// set up brush
var newBrush = new Brush(newCanvas);
newBrush.defaultBrush();

// set up toolbar 
var newToolbar = new Toolbar(newCanvas, newBrush);
newToolbar.setKeyDown(document, 'count');	// enables new canvas add on spacebar, go to next with right arrow, prev with left arrow.
newToolbar.createColorWheel('colorPicker', 200);
newToolbar.setClearCanvas('clearCanvas');
newToolbar.rotateImage('rotateCanvasImage');
newToolbar.undo('undo');
newToolbar.download('download');
newToolbar.importImage('importImage');

// set up filters object
var newFilters = new Filters(newCanvas, newBrush);

document.getElementById('filterSelect').addEventListener('click', function(){ showOptions('filters') });
document.getElementById('brushSelect').addEventListener('click', function(){ showOptions('brushes') });

// show options when clicking on filters or brushes 
function showOptions(category){
	var el = document.getElementById(category);
	var child = el.children[1]; // skip the p element and get the ul element
	if(child.style.display !== "block" ){
		child.style.display = "block";
	}else{
		child.style.display = "none";
		el.style.marginBottom  = 0;
	}
}


// update brush size display
function showSize(){
	document.getElementById('brushSizeValue').textContent = document.getElementById('brushSize').value;
}

// prevent FOUC
$(document).ready(function(){
	$('html').css('display', 'block');
});

</script>


</html>